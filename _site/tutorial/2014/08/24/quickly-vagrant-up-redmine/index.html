
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7 ie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8 ie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9 ie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>Quickly Vagrant Up Redmine</title>
	<meta name="author" content="Nick Ma">
	<link href='/assets/themes/the-minimum/css/style.css' rel="stylesheet" media="all">
	<link href="http://feeds.feedburner.com/" rel="alternate" title="Quickly Vagrant Up Redmine" type="application/atom+xml">
	<script src="http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.0.6/modernizr.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/analytics.js/1.5.2/analytics.min.js"></script>
</head>
<body>

<div id="page" class="hentry">
	<header class="the-header">
		<div class="unit-head">
			<div class="unit-inner unit-head-inner">
				<p class="logo"><a href="/">Nick Ma's Blog</a></p>
				<nav class="nav-global">
					<ul>
            
            
            


  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/Books/index.html">Books</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



					</ul>
				</nav>
			</div><!-- unit-inner -->
		</div><!-- unit-head -->
	</header>
	<div class="body" role="main">
		<div class="unit-body">
			<div class="unit-inner unit-body-inner">
				<div class="entry-content">
					
<article class="unit-article layout-post">
	<div class="unit-inner unit-article-inner">
		<div class="content">
			<header>
				<div class="unit-head">
					<div class="unit-inner unit-head-inner">
						<h1 class="h2 entry-title">Quickly Vagrant Up Redmine</h1>
					</div><!-- unit-inner -->
				</div><!-- unit-head -->
			</header>

			<div class="bd">
				<div class="entry-content">
          <div class="social">
            <ul class="list-linear">
              <li><div class="twitter-follow"><a href="https://twitter.com/NickMa38" class="twitter-follow-button" data-show-count="false" data-lang="en"></a></div></li>
              <li><div class="twitter-tweet"><a href="https://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="NickMa38" data-lang="en">Tweet</a></div></li>
            </ul>
          </div>
					
<p>I am placing these quick tutorials in my <a href="https://github.com/nma/opensource">opensource projects respository</a> so I can have a quick reference on how to spin up new opensource instances when I need them.</p>

<p>Bitnami stacks it really easy to spin up preconfigured stacks for the websites, they have a comprehensive list of open source stuff at <a href="https://bitnami.com/stacks">Bitnami stacks</a>.</p>

<p>You could provision the machines with a <a href="https://bitnami.com/stack/redmine/installer">Bitnami Redmine Installer</a> for Ubuntu and have that run on your Vagrant vm. Alternatively, you could use a 
normal shell script and it will install redmine through the apt-get channels. </p>

<p>If you want to see how to deploy redmine independantly, please check out bootstrap.sh.I did not write it, but I learned a lot of new commands such as defconf-set-selections for provisioning with shell scripts.</p>

<p>For purpose of this tutorial, would be best if we stick with the bitnami stacks, the VagrantFile has commented out the bootstrap.sh and prefers bitnami-bootstrap.sh.
The files can all be located <a href="https://github.com/nma/opensource/redmine">here</a>.</p>

<p>The bashscript is as follows:</p>

<div class="highlight"><pre><code class="bash"><span class="c">#bin/bash</span>

sudo cat &gt; redmine.ini <span class="s">&lt;&lt;EOF</span>
<span class="s">base_user=admin</span>
<span class="s">base_password=redminepwd</span>
<span class="s">redmine_language=en</span>
<span class="s">smtp_email_provider=custom</span>
<span class="s">smtp_enable=1</span>
<span class="s">smtp_user=myemail@mydomain.com</span>
<span class="s">smtp_password=mySMTPPassword</span>
<span class="s">smtp_host=smtp.domain.com</span>
<span class="s">smtp_port=587</span>
<span class="s">smtp_protocol=tls</span>
<span class="s">EOF</span>

<span class="nv">INSTALLER</span><span class="o">=</span>bitnami-redmine

<span class="c"># get the installer</span>
wget -O <span class="nv">$INSTALLER</span> <span class="s2">&quot;https://bitnami.com/redirect/to/39065/bitnami-redmine-2.5.2-1-linux-x64-installer.run&quot;</span> &gt; /dev/null

<span class="nb">echo</span> <span class="s2">&quot;[INFO] Done installing bitnami-redmine installer&quot;</span>

<span class="c"># set permissions</span>
chmod a+x <span class="nv">$INSTALLER</span>

<span class="c"># do the deed</span>
./<span class="nv">$INSTALLER</span> --mode unattended --optionfile redmine.ini
<span class="c"># ssh and configure manually</span>
<span class="c">#./$INSTALLER --mode text  </span>
</code></pre></div>

<p>The Vagrant Environment will take shell script above and provision the VM. The VagrantFile:</p>

<div class="highlight"><pre><code class="ruby"><span class="c1"># -*- mode: ruby -*-</span>
<span class="c1"># vi: set ft=ruby :</span>

<span class="c1"># Vagrantfile API/syntax version. Don&#39;t touch unless you know what you&#39;re doing!</span>
<span class="no">VAGRANTFILE_API_VERSION</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>

<span class="c1"># locate requisite ENV variables or default</span>
<span class="no">BOX_NAME</span> <span class="o">=</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;BOX_NAME&quot;</span><span class="o">]</span> <span class="o">||</span> <span class="s2">&quot;trusty64-amd&quot;</span>
<span class="no">BOX_URI</span> <span class="o">=</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;BOX_URI&quot;</span><span class="o">]</span> <span class="o">||</span> <span class="s2">&quot;https://cloud-images.ubuntu.com/vagrant/trusty/current/trusty-server-cloudimg-amd64-vagrant-disk1.box&quot;</span> 
<span class="no">BOX_MEMORY</span> <span class="o">=</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;BOX_MEMORY&quot;</span><span class="o">]</span> <span class="o">||</span> <span class="s2">&quot;2048&quot;</span>
<span class="no">REDMINE_DOMAIN</span> <span class="o">=</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;REDMINE_DOMAIN&quot;</span><span class="o">]</span> <span class="o">||</span> <span class="s2">&quot;redmine.me&quot;</span>
<span class="no">REDMINE_IP</span> <span class="o">=</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;REDMINE_IP&quot;</span><span class="o">]</span> <span class="o">||</span> <span class="s2">&quot;10.0.0.2&quot;</span>

<span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="no">VAGRANTFILE_API_VERSION</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="c1"># All Vagrant configuration is done here. The most common configuration</span>
  <span class="c1"># options are documented and commented below. For a complete reference,</span>
  <span class="c1"># please see the online documentation at vagrantup.com.</span>

  <span class="c1"># Every Vagrant virtual environment requires a box to build off of.</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="no">BOX_NAME</span>

  <span class="c1"># The url from where the &#39;config.vm.box&#39; box will be fetched if it</span>
  <span class="c1"># doesn&#39;t already exist on the user&#39;s system.</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box_url</span> <span class="o">=</span> <span class="no">BOX_URI</span> 

  <span class="c1"># Create a forwarded port mapping which allows access to a specific port</span>
  <span class="c1"># within the machine from a port on the host machine. In the example below,</span>
  <span class="c1"># accessing &quot;localhost:8080&quot; will access port 80 on the guest machine.</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="s2">&quot;forwarded_port&quot;</span><span class="p">,</span> <span class="ss">guest</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="ss">host</span><span class="p">:</span> <span class="mi">8080</span>

  <span class="c1"># Create a private network, which allows host-only access to the machine</span>
  <span class="c1"># using a specific IP.</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="s2">&quot;private_network&quot;</span><span class="p">,</span> <span class="ss">ip</span><span class="p">:</span> <span class="no">REDMINE_IP</span>
  
  <span class="c1"># tells vagrant to sync just our theme on the virtual machine</span>
  <span class="c1"># comment out to sync everything to /vagrant</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">synced_folder</span> <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">),</span> <span class="s2">&quot;/vagrant/&quot;</span>

  <span class="c1"># tells vagrant to use our hostname</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">REDMINE_DOMAIN</span><span class="si">}</span><span class="s2">&quot;</span>

  <span class="c1"># Provider-specific configuration so you can fine-tune various</span>
  <span class="c1"># backing providers for Vagrant. These expose provider-specific options.</span>
  <span class="c1"># Example for VirtualBox:</span>
  <span class="c1">#</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span> <span class="s2">&quot;virtualbox&quot;</span> <span class="k">do</span> <span class="o">|</span><span class="n">vb</span><span class="o">|</span>
     <span class="c1"># Don&#39;t boot with headless mode</span>
     <span class="c1">#vb.gui = true</span>
  
    <span class="c1"># this option makes the NAT engine use the host&#39;s resolver mechanisms to handle DNS requests </span>
    <span class="c1"># which essentially means that we can specify domain &quot;redmine.me&quot; to be resolved by our local hosts file </span>
    <span class="c1">#vb.customize [&quot;modifyvm&quot;, :id, &quot;--natdnshostresolver1&quot;, &quot;on&quot;]</span>
    <span class="c1"># set the memory of the virtualbox</span>
    <span class="n">vb</span><span class="o">.</span><span class="n">customize</span> <span class="o">[</span><span class="s2">&quot;modifyvm&quot;</span><span class="p">,</span> <span class="ss">:id</span><span class="p">,</span> <span class="s2">&quot;--memory&quot;</span><span class="p">,</span> <span class="no">BOX_MEMORY</span><span class="o">]</span>
  <span class="k">end</span>

  <span class="c1"># once the vm is started</span>
  <span class="c1"># use the bootstrap.sh file to install and setup redmine</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span> <span class="s2">&quot;shell&quot;</span><span class="p">,</span> <span class="ss">path</span><span class="p">:</span> <span class="s2">&quot;bitnami-bootstrap.sh&quot;</span>
  <span class="c1"># config.vm.provision &quot;shell&quot;, path: &quot;update-theme.sh&quot;</span>
<span class="k">end</span>
</code></pre></div>

<p>If you check out the other files in the repository, you can find the bootstrap.sh method, which demonstrates how redmine can be provisioned from pure shell script. 
I plan to add on a chef provisioner as I am currently planning to look into that, a puppet provisioner may follow soon as well.</p>

<p><code>
vagrant up
</code>
You should see redmine at 10.0.0.2/redmine</p>

					<div class="meta">
						<p class="date-publish">
							Published: 
							<date class="date-pub" title="2014-08-24T00:00:00-07:00" datetime="2014-08-24T00:00:00-07:00" pubdate>
							<span class="month"><abbr>August</abbr></span>
							<span class="day">24</span>
							<span class="year">2014</span>
							</date>
						</p>
						<ul class="list-category list-linear">
							<li class="list-head">category: </li>
							
							


  
     
    	<li><a href="/categories.html#tutorial-ref">
    		tutorial <span>3</span>
    	</a></li>
    
  


						</ul>
						<ul class="list-tag list-linear">
							<li class="list-head">tags: </li>
							
							


  
     
    	<li><a href="/tags.html#Vagrant-ref">Vagrant <span>3</span></a></li>
     
    	<li><a href="/tags.html#Redmine-ref">Redmine <span>1</span></a></li>
     
    	<li><a href="/tags.html#Bitnami-ref">Bitnami <span>1</span></a></li>
    
  



						</ul>
					</div><!-- meta -->
				</div><!-- entry-content -->

				<div class="misc-content">	
					


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'nickmablog'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




				</div><!-- misc-content -->
				
			</div><!-- bd -->
			<footer class="unit-foot">
				<div class="unit-inner unit-foot-inner">
					<nav class="pagination">
						<ul>
							
							<li class="prev"><a class="internal" rel="prev"  href="/tutorial/2014/07/19/testing-custom-linux-kernels-on-vagrant" title="View Testing Custom Linux Kernels on Vagrant.">&laquo; Testing Custom Linux Kernels on Vagrant.</a></li>
							

							

							
						</ul>
					</nav>
					<p class="gotop">
						<a href="#page">Back to Top</a>
					</p>
				</div>
			</footer>

		</div><!-- content -->
	</div><!-- unit-inner -->
</article>


				</div>
			</div><!-- unit-inner -->
		</div><!-- unit-body -->
	</div><!-- body -->
	<footer class="the-footer">
		<div class="unit-foot">
			<div class="unit-inner unit-foot-inner">
				<div class="misc vcard">
					<h4>about</h4>
					<ul>
						<li class="contact"><address><span class="author fn n">Nick Ma</span> - <span class="fn email">{ MY FIRST NAME }@nickma.com</span></address></li>
						<li class="github"><a href="http://github.com/nma/" rel="me">github.com/nma</a></li>
						<li class="twitter"><a href="http://twitter.com/NickMa38/" rel="me">twitter.com/NickMa38</a></li>
						<li class="rss"><a href="http://feeds.feedburner.com/">Subscribe to RSS Feed</a></li>
					</ul>
				</div><!-- misc -->
				<p class="licence">
					Theme: <a href="http://layouts-the.me">the_minimum</a> based on <a href="http://jekyllbootstrap.com/">Jekyll-bootstrap</a>.<br>
					Powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a>.
				</p>
			</div><!-- unit-foot-inner -->
		</div><!-- unit-foot -->
	</footer>
</div><!-- page -->
<script>
	(function(d, s) {
		var js, fjs = d.getElementsByTagName(s)[0], load = function(url, id) {
		if (d.getElementById(id)) {return;}
		js = d.createElement(s); js.src = url; js.id = id;
		fjs.parentNode.insertBefore(js, fjs);
		};
	load('//platform.twitter.com/widgets.js', 'tweetjs');
	// load('https://apis.google.com/js/plusone.js', 'gplus1js'); // Checkout http://j.mp/ApDgMr for usage html for this is <div class="g-plusone" data-size="medium"></div>
	// load('//connect.facebook.net/en_US/all.js#xfbml=1', 'fbjssdk'); // Checkout http://j.mp/wZw2xR for using open graph protorol html for this is <div class="fb-like" data-href="/tutorial/2014/08/24/quickly-vagrant-up-redmine" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false" data-font="verdana"></div>

    var images = document.getElementsByTagName('img');
    var myImge = null;
    for(var i = 0; i < images.length; ++i) {
      myImage = images[i];
      myImage.onload = function() { 
        console.log(this.parentNode.tagName);
        if ((this.offsetWidth > this.parentNode.offsetWidth) && (this.parentNode.tagName.toLowerCase() !== 'a')) {
          this.style.width = this.parentNode.offsetWidth + "px";
          this.style.height = "100%";
        }
      }
    }

	}(document, 'script'));
</script>
<script>
/*! A fix for the iOS orientationchange zoom bug.Script by @scottjehl, rebound by @wilto. MIT License.*/
(function(j){var i=j.document;if(!i.querySelectorAll){return}var l=i.querySelectorAll("meta[name=viewport]")[0],a=l&&l.getAttribute("content"),h=a+", maximum-scale=1.0",d=a+", maximum-scale=10.0",g=true,c=j.orientation,k=0;if(!l){return}function f(){l.setAttribute("content",d);g=true}function b(){l.setAttribute("content",h);g=false}function e(m){c=Math.abs(j.orientation);k=Math.abs(m.gamma);if(k>8&&c===0){if(g){b()}}else{if(!g){f()}}}j.addEventListener("orientationchange",f,false);j.addEventListener("deviceorientation",e,false)})(this);
</script>

  
</body>
</html>

